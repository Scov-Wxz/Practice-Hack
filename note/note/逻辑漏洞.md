# 逻辑漏洞

## 支付漏洞

- 支付金额溢出
  - 原理
    - Int 类型最大值 2_147_483_647
    - 超过后会从 0 开始，则 1=2_147_483_649
  - 利用
    - 修改金额
    - 修改数量
- 购买数量为小数
  - 1.49->1 ; 1.5->2
  - 第三方支付最小单位到 0.01 ; 修改金额 0.019 -> 第三方支付 0.1 但平台充值 0.2
- 重复购买限购商品：签约漏洞&无限首充
  - e.g.同一个二维码，多个设备扫进入支付界面
  - e.g.QQ 普通会员升超级会员，只用支付差价，多个设备进入支付界面
- 越权替别人支付
  - e.g.VIP 为普通用户支付
  - e.g.平台和游戏账号分开，平台领取代金券修改游戏角色 uid 为其他账号利用
- 并发
  - e.g.优惠券只能用一次，创建优惠券订单，拦截请求包复制多份并发发出，创建多个有优惠券订单
    - 请求包存在时间戳、随机参数、sign、token 等，开启拦截，客户端模拟点击多次再放行
  - e.g.提现 ; 有些并发需要满足兑换 2 次才能多并发成功，商品价格为 2，余额为 4 或 5 多并发成功
- 返回值
  - sign、token 与本地生成的报文(请求包或前端?)挂钩，提前修改
  - 手动添加其他参数：活动补贴含参数商家自设补贴但未显示，修改邮箱参数含参数手机号可一并修改但未显示，手动添加
- 验证码绕过
  - 普通拦截修改返回包，感觉现在就绕前端等（

## 验证码

- 改请求包，拼接手机号
  - 多发
  - 多个手机号同个验证码
- 短信轰炸
- 内容修改
